<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Profil</title>
    <script type="module">
        import { bonusCodes } from './bonuscodes.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBmnEMGPec-dzIANP0pvGT3Lbvm51zFjaY",
            authDomain: "knoedelbrot-1d1de.firebaseapp.com",
            projectId: "knoedelbrot-1d1de",
            storageBucket: "knoedelbrot-1d1de.firebasestorage.app",
            messagingSenderId: "906476242509",
            appId: "1:906476242509:web:989fbc20dee736f1eb7e04"
        };

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const email = urlParams.get('email');
            if (!email) {
                alert("Keine Benutzerinformationen!");
                return;
            }

            const userRef = doc(db, "users", email);
            const docSnap = await getDoc(userRef);

            if (!docSnap.exists()) {
                alert("Benutzer nicht gefunden!");
                return;
            }

            const data = docSnap.data();
            document.getElementById("email").textContent = email;
            document.getElementById("bonus").textContent = data.bonus || "kein Bonus";
        });

        window.logout = () => {
            document.cookie = "bonus=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
            window.location.href = "login.html";
        }
    </script>
</head>
<body>
    <h1>Profil</h1>
    <p>Email: <span id="email"></span></p>
    <p>Bonus: <span id="bonus"></span></p>
    <button onclick="logout()">Logout</button>
</body>
</html>
